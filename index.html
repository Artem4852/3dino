<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <title>Dino game</title>
</head>
<body>
    <a-scene id="scene">
        <a-assets data-total-assets="26">
            <a-asset-item id="cactus_small_1_obj" src="assets/cactus_small_1.obj"></a-asset-item>
            <a-asset-item id="cactus_small_1_mtl" src="assets/cactus_small_1.mtl"></a-asset-item>
            <a-asset-item id="cactus_small_2_obj" src="assets/cactus_small_2.obj"></a-asset-item>
            <a-asset-item id="cactus_small_2_mtl" src="assets/cactus_small_2.mtl"></a-asset-item>
            <a-asset-item id="cactus_big_1_obj" src="assets/cactus_big_1.obj"></a-asset-item>
            <a-asset-item id="cactus_big_1_mtl" src="assets/cactus_big_1.mtl"></a-asset-item>
            <a-asset-item id="cactus_big_2_obj" src="assets/cactus_big_2.obj"></a-asset-item>
            <a-asset-item id="cactus_big_2_mtl" src="assets/cactus_big_2.mtl"></a-asset-item>
            <a-asset-item id="cactus_big_3_obj" src="assets/cactus_big_3.obj"></a-asset-item>
            <a-asset-item id="cactus_big_3_mtl" src="assets/cactus_big_3.mtl"></a-asset-item>
            <a-asset-item id="floor_1_obj" src="assets/floor_1.obj"></a-asset-item>
            <a-asset-item id="floor_1_mtl" src="assets/floor_1.mtl"></a-asset-item>
            <a-asset-item id="floor_2_obj" src="assets/floor_2.obj"></a-asset-item>
            <a-asset-item id="floor_2_mtl" src="assets/floor_2.mtl"></a-asset-item>
            <a-asset-item id="floor_3_obj" src="assets/floor_3.obj"></a-asset-item>
            <a-asset-item id="floor_3_mtl" src="assets/floor_3.mtl"></a-asset-item>
            <a-asset-item id="floor_4_obj" src="assets/floor_4.obj"></a-asset-item>
            <a-asset-item id="floor_4_mtl" src="assets/floor_4.mtl"></a-asset-item>
            <a-asset-item id="pteranodon_base_obj" src="assets/pteranodon_base.obj"></a-asset-item>
            <a-asset-item id="pteranodon_base_mtl" src="assets/pteranodon_base.mtl"></a-asset-item>
            <a-asset-item id="pteranodon_wing_l_obj" src="assets/pteranodon_wing_l.obj"></a-asset-item>
            <a-asset-item id="pteranodon_wing_l_mtl" src="assets/pteranodon_wing_l.mtl"></a-asset-item>
            <a-asset-item id="pteranodon_wing_r_obj" src="assets/pteranodon_wing_r.obj"></a-asset-item>
            <a-asset-item id="pteranodon_wing_r_mtl" src="assets/pteranodon_wing_r.mtl"></a-asset-item>
            <a-asset-item id="floor_roll_obj" src="assets/floor_roll.obj"></a-asset-item>
            <a-asset-item id="floor_roll_mtl" src="assets/floor_roll.mtl"></a-asset-item>
        </a-assets>

        <a-entity id="camera" camera look-controls wasd-controls position="0 3 0"></a-entity>
        <!-- <a-entity id="camera" camera look-controls custom-wasd-controls position="0 3 0"></a-entity> -->

        <a-sky color="#EEEEEE"></a-sky>
        <!-- <a-light type="directional" color="#EEEEEE" intensity="1" position="-1 2 1" castShadow="true"></a-light> -->
        
        <!-- prefabs -->
        <a-obj-model id="cactus_small_1" data-obstacle_type="short_cactus" src="#cactus_small_1_obj" mtl="#cactus_small_1_mtl" scale="1 1 1" position="0 -10 0" material="shader: standard" visible="false"></a-obj-model>
        <a-obj-model id="cactus_small_2" data-obstacle_type="short_cactus" src="#cactus_small_2_obj" mtl="#cactus_small_2_mtl" scale="1 1 1" position="0 -10 0" material="shader: standard" visible="false"></a-obj-model>
        <a-obj-model id="cactus_big_1" data-obstacle_type="tall_cactus" src="#cactus_big_1_obj" mtl="#cactus_big_1_mtl" scale="1 1 1" position="0 -10 0" material="shader: standard" visible="false"></a-obj-model>
        <a-obj-model id="cactus_big_2" data-obstacle_type="tall_cactus" src="#cactus_big_2_obj" mtl="#cactus_big_2_mtl" scale="1 1 1" position="0 -10 0" material="shader: standard" visible="false"></a-obj-model>
        <a-obj-model id="cactus_big_3" data-obstacle_type="tall_cactus" src="#cactus_big_3_obj" mtl="#cactus_big_3_mtl" scale="1 1 1" position="0 -10 0" material="shader: standard" visible="false"></a-obj-model>
        
        <a-obj-model id="floor_1" src="#floor_1_obj" mtl="#floor_1_mtl" scale="1 1 1" position="0 -10 0" material="shader: standard" visible="false"></a-obj-model>
        <a-obj-model id="floor_2" src="#floor_2_obj" mtl="#floor_2_mtl" scale="1 1 1" position="0 -10 0" material="shader: standard" visible="false"></a-obj-model>
        <a-obj-model id="floor_3" src="#floor_3_obj" mtl="#floor_3_mtl" scale="1 1 1" position="0 -10 0" material="shader: standard" visible="false"></a-obj-model>
        <a-obj-model id="floor_4" src="#floor_4_obj" mtl="#floor_4_mtl" scale="1 1 1" position="0 -10 0" material="shader: standard" visible="false"></a-obj-model>

        <a-entity id="pteranodon" data-obstacle_type="pteranodon" position="0 -10 0" visible="false">
            <a-obj-model src="#pteranodon_base_obj" mtl="#pteranodon_base_mtl" scale="1 1 1" position="0 0 0" material="shader: standard"></a-obj-model>
            <a-obj-model src="#pteranodon_wing_l_obj" mtl="#pteranodon_wing_l_mtl" scale="1 1 1" position="0 0.78 -3.03806" material="shader: standard"></a-obj-model>
            <a-obj-model src="#pteranodon_wing_r_obj" mtl="#pteranodon_wing_r_mtl" scale="1 1 1" position="0 0.78 -3.03806" material="shader: standard"></a-obj-model>
        </a-entity>

        <a-obj-model class="floor_roll" src="#floor_roll_obj" mtl="#floor_roll_mtl" scale="1 1 1"
            position="0 11.6 -50"></a-obj-model>
        <a-obj-model class="floor_roll" src="#floor_roll_obj" mtl="#floor_roll_mtl" scale="1 1 1"
            position="0 11.6 50"></a-obj-model>
    </a-scene>

    <div id="start" class="menu">
        <h1>Dino Dash 3D</h1>
        <h2 id="loading-text">Loading...</h2>
        <div id="loading-wrapper">
            <div id="loading-bar"></div>
        </div>
        <button id="start-button" onclick="start()">Start</button>
        <div class="controls" id="controls-desktop">
            <h2>Controls (desktop):</h2>
            <h3>Jump: W</h3>
            <h3>Crouch: Shift</h3> 
        </div>
        <div class="controls">
            <h2>Controls (mobile):</h2>
            <h3>Jump: swipe up</h3>
            <h3>Crouch: swipe down</h3>
        </div>
    </div>

    <div id="pause" class="menu">
        <h1>Dino Dash 3D</h1>
        <h2>Pause.</h2>
        <button id="start-button" class="activeButton" onclick="unpause()">Continue</button>
        <button id="start-button" class="activeButton" onclick="restart()">Restart</button>
        <div class="controls">
            <h2>Controls (desktop):</h2>
            <h3>Jump: W</h3>
            <h3>Crouch: C</h3> 
        </div>
        <div class="controls">
            <h2>Controls (mobile):</h2>
            <h3>Jump: swipe up</h3>
            <h3>Crouch: swipe down</h3>
        </div>
    </div>

    <div id="lost" class="menu">
        <h1>Dino Dash 3D</h1>
        <h2>Womp womp. You lost...</h2>
        <h2>Your score: <span id="score-menu">0</span></h2>
        <button id="start-button" class="activeButton" onclick="restart()">Restart</button>
    </div>

    <div id="topbar">
        <h2>Score: <span id="score">0</span></h2>
        <button id="pause-button" onclick="pauseGame()">
            <div class="vertical"></div>
            <div class="vertical"></div>
        </button>
    </div>

    <script>
        // AFRAME.registerComponent('custom-wasd-controls', {
        //     init: function () {
        //         this.el.addEventListener('keydown', (event) => {
        //             if (['w', 'a', 's', 'd'].includes(event.key.toLowerCase())) {
        //                 event.preventDefault();
        //             }
        //         });
        //     }
        // });

        // The best way I could think of to get dimensions of the floor...
        // AFRAME.registerComponent('get-dimensions', {
        //     init: function () {
        //         this.el.addEventListener('model-loaded', () => {
        //             const mesh = this.el.getObject3D('mesh');
        //             if (mesh) {
        //                 const box = new THREE.Box3().setFromObject(mesh);
        //                 const size = box.getSize(new THREE.Vector3());
        //                 console.log(this.el.getAttribute('src'));

        //                 console.log('Dimensions:', size);

        //                 const position = this.el.object3D.position;
        //                 const endX = position.x + size.x * this.el.object3D.scale.x / 2;
        //             }
        //         });
        //     }
        // });
    </script>
    <script src="camera.js"></script>
    <script src="level.js"></script>
</body>
</html>